<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How's The Roads? | Live Kansas City Traffic Cameras & Road Conditions</title>
    <meta name="description" content="Check live KCMO traffic cameras to navigate Kansas City road conditions with ease. Real-time updates on traffic, weather, and road conditions to plan your commute and avoid delays.">
    <meta name="keywords" content="KCMO traffic cameras, Kansas City road conditions, live traffic cams KC, Kansas City weather traffic, real-time road conditions KC, KCMO commute updates, Missouri highway cameras, KC traffic live feed, winter road conditions Kansas City, I-70 traffic cam KC, KC metro traffic, Missouri DOT cameras, Kansas City interstate cameras, downtown KC traffic, Plaza traffic cameras">
    <meta name="author" content="How's the Roads?">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="revisit-after" content="7 days">
    <meta name="language" content="English">
    <meta name="geo.region" content="US-MO">
    <meta name="geo.placename" content="Kansas City">
    <meta name="geo.position" content="39.0997;-94.5786">
    <meta name="ICBM" content="39.0997, -94.5786">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://howstheroads.com">
    
    <!-- Smart App Banner for iOS -->
    <meta name="apple-itunes-app" content="app-id=6742173400">
    
    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:title" content="How's The Roads? - Live Kansas City Traffic Cameras">
    <meta property="og:description" content="Check live KCMO traffic cams to navigate weather and road conditions with ease. Plan your commute and avoid delays with real-time updates.">
    <meta property="og:image" content="https://howstheroads.com/og.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:url" content="https://howstheroads.com">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="How's The Roads?">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="How's The Roads? - Live Kansas City Traffic Cameras">
    <meta name="twitter:description" content="Check live KCMO traffic cams to navigate weather and road conditions with ease. Plan your commute and avoid delays with real-time updates.">
    <meta name="twitter:image" content="https://howstheroads.com/og.png">
    <meta name="twitter:site" content="@howstheroads">
    
    <!-- Favicon and Apple Touch Icons -->
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="apple-touch-icon" href="/appicon.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <!-- Preconnect to external domains -->
    <link rel="preconnect" href="https://cdn.plyr.io">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://kit.fontawesome.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css">
    <script src="https://kit.fontawesome.com/53df3a2a07.js" crossorigin="anonymous"></script>
    
    <!-- Structured Data / JSON-LD -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "How's The Roads?",
      "url": "https://howstheroads.com",
      "description": "Check live KCMO traffic cams to navigate weather and road conditions with ease. Plan your commute and avoid delays with real-time updates.",
      "applicationCategory": "Transportation",
      "operatingSystem": "Web",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "author": {
        "@type": "Organization",
        "name": "How's The Roads?",
        "url": "https://howstheroads.com"
      },
      "contentLocation": {
        "@type": "City",
        "name": "Kansas City",
        "address": {
          "@type": "PostalAddress",
          "addressRegion": "MO",
          "addressCountry": "US"
        }
      }
    }
    </script>
    
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "https://howstheroads.com"
      }]
    }
    </script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,100..900;1,100..900&display=swap');

        :root {
            --color-primary: #E31837;
            --color-secondary: #FFB81C;
            --color-tertiary: #ffe6af;
        }
        *,
        html {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        ::selection {
            background-color: var(--color-primary);
            color: var(--color-secondary);
        }
        ::-webkit-selection {
            background-color: var(--color-primary);
            color: var(--color-secondary);
        }
        body {
            font-family: "Public Sans", sans-serif;
            position: relative;
            overflow-x: hidden;
            color: white;
            background-color: black;
        }
        a {
            transition: all 0.15s ease-in-out;
            color: white;
            font-weight: 700;
            text-decoration: none;
        }
        a:hover {
            opacity: 0.6;
        }
        h1 {
            text-transform: uppercase;
            font-size: 1.6rem;
            font-weight: 800;
            text-shadow: 0 4px 0 rgba(0, 0, 0, 0.2);
        }
        h2 {
            font-size: 1.1rem;
            font-weight: 600;
            text-shadow: 0 2px 0 rgba(0, 0, 0, 0.2);
        }
        h3 {
            font-size: 1.1rem;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.6);
        }
        small {
            font-size: 0.8rem;
        }
        main {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            padding: 0.75rem;
            padding-bottom: 0;
            position: relative;
            z-index: 1; /* Ensure content is above the overlay */
            background-color: var(--color-primary);
        }
        header,
        footer,
        .video-container {
            display: flex;
            flex-wrap: wrap;
            max-width: 1200px;
            gap: 0.75rem;
            width: 100%;
            animation: welcome 0.25s ease-in-out;
        }
        header,
        footer {
            justify-content: space-between;
            align-items: center;
            gap: 1.5rem;
            padding-top: 1.5rem;
            padding-bottom: 1.5rem;
        }
        header nav,
        footer nav {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            flex-wrap: wrap;
        }
        .highlight {
            display: flex;
            align-items: center;
            font-size: 1.1rem;
            gap: 0.25rem;
            background-color: var(--color-secondary);
            padding: 0.75rem;
            border-radius: 0.75rem;
            color: var(--color-primary);
            text-shadow: none;
            box-shadow: 0 4px 0 rgba(0, 0, 0, 0.2);
            position: relative;
            transition: all 0.15s ease-in-out;
            font-weight: 700;
            text-decoration: none;
            cursor: pointer;
            border: none;
        }
        
        .highlight:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 0 rgba(0, 0, 0, 0.2);
        }
        
        .highlight:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0 rgba(0, 0, 0, 0.2);
        }
        
        .highlight-app {
            position: relative;
        }
        
        .highlight-app:hover small {
            transform: translate(-0.75rem, -70%) scale(1.1);
        }
        
        .highlight-app small {
            transition: all 0.15s ease-in-out;
            font-size: 0.75rem;
            font-weight: 800;
            position: absolute;
            top: 0;
            right: 0;
            transform: translate(-0.75rem, -60%);
            padding: 0.25rem 0.5rem;
            background-color: white;
            color: var(--color-primary);
            border-radius: 9999px;
            box-shadow: 0 2px 0 rgba(0, 0, 0, 0.2);
        }
        
        .highlight-fullwidth {
            width: 100%;
            max-width: 1200px;
            justify-content: center;
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }
        .logo img {
            width: 3rem;
            height: 3rem;
            opacity: 0.4;
        }
        .video-item {
            transition: all 0.15s ease-in-out;
            display: flex;
            flex-direction: column;
            flex: 1;
            min-width: 320px;
            height: 320px;
            border: 4px solid rgba(255, 255, 255, 0.2);
            border-radius: 0.75rem;
            overflow: hidden;
            animation: welcome 0.5s ease-in-out;
        }
        .video-item h2 {
            background-color: rgba(0, 0, 0, 0.5);
            padding: 0.75rem;
            text-align: center;
        }
        .video-item video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .vjs-theme-city {
            --vjs-theme-city--primary: var(--color-primary);
            --vjs-theme-city--secondary: black;
        }

        /* Plyr custom styles */
        .plyr {
            height: 100%;
            --plyr-color-main: var(--color-primary);
        }
        
        .plyr video {
            object-fit: cover;
        }

        /* Hide some Plyr controls for cleaner look */
        .plyr--video .plyr__controls {
            background: linear-gradient(rgba(0,0,0,0), rgba(0,0,0,0.6));
            padding: 8px;
        }
        
        @keyframes welcome {
            from {
                opacity: 0;
                transform: translateY(10rem);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .loading-message {
            text-align: center;
            color: white;
            font-size: 1.2rem;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .main-container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .video-item h2 a {
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .video-item h2 a:hover {
            color: var(--color-secondary);
        }

        .video-item h2 a i {
            font-size: 0.8em;
        }

        /* Load more button styles */
        .load-more-container {
            width: 100%;
            display: flex;
            justify-content: center;
            margin: 1.5rem 0;
        }
    </style>
</head>
<body>
    <main class="main-container">
        <header>
            <h1><i class="fa-solid fa-road"></i> How's The Roads?</h1>
            <nav>
                <a href="https://forecast.weather.gov/MapClick.php?CityName=Kansas+City&state=MO&site=EAX&textField1=39.0904&textField2=-94.5837&e=0" 
                   target="_blank" 
                   title="View detailed KC weather forecast">
                    <h2 id="temperature-text">fetching...</h2>
                </a>
                <a href="https://apps.apple.com/us/app/hows-the-roads/id6742173400" target="_blank" class="highlight highlight-app">get the app <small>new!</small><i class="fa-solid fa-arrow-up-right-from-square"></i></a>
            </nav>
        </header>
        <div id="loading-message" class="loading-message">
            <h3>loading kansas city...</h3>
        </div>
        <div class="video-container" id="video-container" style="display: none;">
            <!-- Video items will be dynamically inserted here -->
        </div>
        <div class="load-more-container" id="load-more-container" style="display: none;">
            <button class="highlight highlight-fullwidth" id="load-more-btn">
                <i class="fa-solid fa-plus"></i> load more
            </button>
        </div>
        <footer>
            <nav>
                <h3><a href="/"><i class="fa-solid fa-arrows-rotate"></i> refresh</a></h3>
                <h3><a href="https://forms.gle/ZnyUcmjtj7SFWeyo8" target="_blank"><i class="fa-solid fa-video"></i> request</a></h3>
            </nav>
            <nav>
                <div class="logo">
                    <h3>safe travels</h3>
                    <img src="/kc.svg" alt="kcmo" />
                </div>
                <a href="https://apps.apple.com/us/app/how-the-roads/id6742173400" target="_blank" class="highlight highlight-app">get the app <small>new!</small><i class="fa-solid fa-arrow-up-right-from-square"></i></a>
            </nav>
        </footer>
    </main>
    <script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script>
        /**
         * Main application script for How's The Roads
         * This script handles:
         * 1. Fetching and displaying traffic camera feeds
         * 2. Implementing the load more functionality
         * 3. Fetching and displaying current weather conditions
         */

        // ===== TRAFFIC CAMERA FUNCTIONALITY =====
        
        /**
         * Fetch traffic camera data from JSON endpoint and populate the video container
         * The JSON contains an array of camera objects with name, URL, latitude, and longitude
         */
        fetch('https://0xblz.github.io/docs/kansascity.json')
            .then(response => response.json())
            .then(data => {
                // Extract the videos array from the response
                const videos = data.videos || data; // Handle different possible JSON structures
                
                // Validate that we received proper video data
                if (!videos || !Array.isArray(videos)) {
                    throw new Error('Invalid video data format');
                }

                // Get DOM references
                const videoContainer = document.getElementById('video-container');
                const loadingMessage = document.getElementById('loading-message');
                const loadMoreContainer = document.getElementById('load-more-container');
                const loadMoreBtn = document.getElementById('load-more-btn');
                
                // Store all videos for pagination
                const allVideos = [...videos];
                
                // Pagination configuration
                const videosPerLoad = 9; // Number of videos to show initially and on each "Load More" click
                let videosLoaded = 0; // Track how many videos have been loaded so far
                
                /**
                 * Load a batch of videos into the container
                 * @param {number} start - Starting index in the videos array
                 * @param {number} count - Number of videos to load
                 */
                function loadVideos(start, count) {
                    // Get the subset of videos to load in this batch
                    const videosToLoad = allVideos.slice(start, start + count);
                    
                    // Create and append video elements for each camera
                    videosToLoad.forEach(video => {
                        // Create container for this video
                        const videoItem = document.createElement('div');
                        videoItem.className = 'video-item';
                        
                        // Create Google Maps link with the camera's coordinates
                        const mapsUrl = `https://www.google.com/maps?q=${video.latitude},${video.longitude}`;
                        
                        // Build the HTML for this camera item
                        videoItem.innerHTML = `
                            <h2><a href="${mapsUrl}" target="_blank" title="View on map"><i class="fa-solid fa-location-dot"></i> ${video.name}</a></h2>
                            <video controls crossorigin playsinline autoplay muted>
                                <source src="${video.url}" type="application/x-mpegURL">
                            </video>
                        `;
                        videoContainer.appendChild(videoItem);
                        
                        // Initialize video player for this camera
                        const videoElement = videoItem.querySelector('video');
                        initializeVideoPlayer(videoElement);
                    });
                    
                    // Update the count of loaded videos
                    videosLoaded += videosToLoad.length;
                    
                    // Show/hide "Load More" button based on whether all videos are loaded
                    if (videosLoaded >= allVideos.length) {
                        loadMoreContainer.style.display = 'none'; // All videos loaded, hide button
                    } else {
                        loadMoreContainer.style.display = 'flex'; // More videos available, show button
                    }
                }
                
                /**
                 * Initialize the Plyr video player with HLS.js for streaming support
                 * @param {HTMLVideoElement} video - The video element to initialize
                 */
                function initializeVideoPlayer(video) {
                    if (Hls.isSupported()) {
                        // Use HLS.js for browsers that don't natively support HLS streams
                        const hls = new Hls();
                        hls.loadSource(video.querySelector('source').src);
                        hls.attachMedia(video);
                        
                        // Initialize Plyr once HLS manifest is parsed
                        hls.on(Hls.Events.MANIFEST_PARSED, () => {
                            new Plyr(video, {
                                controls: ['play', 'mute', 'volume', 'fullscreen'],
                                hideControls: true,
                                resetOnEnd: true,
                                keyboard: false
                            });
                        });
                    } else {
                        // Fallback for browsers with native HLS support
                        new Plyr(video, {
                            controls: ['play', 'mute', 'volume', 'fullscreen'],
                            hideControls: true,
                            resetOnEnd: true,
                            keyboard: false
                        });
                    }
                }
                
                // Load the initial batch of videos
                loadVideos(0, videosPerLoad);
                
                // Hide loading message and show video container
                loadingMessage.style.display = 'none';
                videoContainer.style.display = 'flex';
                
                // Add event listener to "Load More" button
                loadMoreBtn.addEventListener('click', () => {
                    loadVideos(videosLoaded, videosPerLoad);
                });
            })
            .catch(error => {
                // Handle errors in fetching or processing video data
                console.error('Error fetching video data:', error);
                document.getElementById('loading-message').textContent = "Error loading videos.";
            });

        // ===== WEATHER FUNCTIONALITY =====
        
        /**
         * Fetch current weather data from NOAA API for Kansas City International Airport (KMCI)
         * Displays temperature and appropriate weather emoji based on conditions
         */
        fetch(`https://api.weather.gov/stations/KMCI/observations/latest`, {
            headers: {
                'User-Agent': '(howstheroads.com, contact@howstheroads.com)'
            }
        })
        .then(response => response.json())
        .then(data => {
            // Extract and convert temperature from Celsius to Fahrenheit
            const tempC = data.properties.temperature.value || 0;
            const tempF = Math.round((tempC * 9/5) + 32);
            
            // Determine if it's currently night time (between 8PM and 6AM)
            const hour = new Date().getHours();
            const isNight = hour < 6 || hour >= 20;
            
            // Get appropriate weather emoji based on current conditions
            const emoji = determineWeatherEmoji(
                data.properties.cloudLayers,
                data.properties.presentWeather,
                data.properties.visibility?.value,
                data.properties.relativeHumidity?.value,
                isNight
            );
            
            // Update the temperature display
            document.getElementById('temperature-text').textContent = `${emoji} ${tempF}¬∞f in kc`;
        })
        .catch(error => {
            // Handle errors in fetching or processing weather data
            console.error('Error fetching weather:', error);
            document.getElementById('temperature-text').textContent = "Unable to load temperature";
        });

        /**
         * Determine the appropriate weather emoji based on current conditions
         * 
         * @param {Array} cloudLayers - Cloud coverage information
         * @param {Array} presentWeather - Current weather phenomena (rain, snow, etc.)
         * @param {number} visibility - Visibility in meters
         * @param {number} humidity - Relative humidity percentage
         * @param {boolean} isNight - Whether it's currently night time
         * @returns {string} - Weather emoji representing current conditions
         */
        function determineWeatherEmoji(cloudLayers, presentWeather, visibility, humidity, isNight) {
            // Check for active weather conditions first (priority)
            if (presentWeather && presentWeather.length > 0) {
                const weather = (presentWeather[0].weather || '').toLowerCase();
                if (weather.includes('thunder')) return '‚õàÔ∏è'; // Thunderstorm
                if (weather.includes('rain') || weather.includes('shower')) return 'üåßÔ∏è'; // Rain
                if (weather.includes('snow')) return '‚ùÑÔ∏è'; // Snow
            }
            
            // Check visibility for fog/mist (second priority)
            if (visibility && visibility < 10000) return 'üå´Ô∏è'; // Fog or mist
            
            // Determine cloud coverage if no precipitation or fog
            if (!cloudLayers || cloudLayers.length === 0) {
                return isNight ? 'üåô' : '‚òÄÔ∏è'; // Clear skies (night/day)
            }
            
            // Different cloud coverage levels
            const cloudAmount = (cloudLayers[0].amount || '').toLowerCase();
            switch (cloudAmount) {
                case 'overcast': return '‚òÅÔ∏è'; // Completely cloudy
                case 'broken': return 'üå•Ô∏è';   // Mostly cloudy
                case 'scattered': return '‚õÖ'; // Partly cloudy
                case 'few': return 'üå§Ô∏è';      // Mostly clear
                default: return isNight ? 'üåô' : '‚òÄÔ∏è'; // Default to clear if unknown
            }
        }
    </script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-LX0GQ46N1N"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-LX0GQ46N1N');
    </script>
</body>
</html>